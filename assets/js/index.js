(()=>{"use strict";var e={n:a=>{var t=a&&a.__esModule?()=>a.default:()=>a;return e.d(t,{a:t}),t},d:(a,t)=>{for(var n in t)e.o(t,n)&&!e.o(a,n)&&Object.defineProperty(a,n,{enumerable:!0,get:t[n]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)};const a=window.React,t=window.wp.element,n=[{id:"dashboard",label:"Dashboard"},{id:"firewall",label:"Firewall"},{id:"scanner",label:"Scanner"},{id:"hardening",label:"Hardening"},{id:"activity",label:"Activity Log"},{id:"settings",label:"Settings"},{id:"more",label:"More"}],l=({currentView:e,onNavigate:t})=>(0,a.createElement)("header",{className:"top-bar"},(0,a.createElement)("div",{className:"brand"},(0,a.createElement)("span",{className:"brand-icon","aria-hidden":"true"},(0,a.createElement)("svg",{viewBox:"0 0 24 24",role:"img",focusable:"false",preserveAspectRatio:"xMidYMid meet"},(0,a.createElement)("path",{d:"M12 2L4 5.4v6.2c0 5.1 3.4 9.7 8 10.4 4.6-.7 8-5.3 8-10.4V5.4L12 2zm0 2.2l6 2.3v5.1c0 4-2.5 7.6-6 8.3-3.5-.7-6-4.3-6-8.3V6.5l6-2.3z"}),(0,a.createElement)("path",{d:"M10.5 12.7l-2-2-1.3 1.3 3.3 3.3 5.3-5.3-1.3-1.3-4 4z"}))),(0,a.createElement)("span",{className:"brand-name"},"WP Security Pilot")),(0,a.createElement)("nav",{className:"main-nav","aria-label":"Primary"},n.map(n=>(0,a.createElement)("button",{key:n.id,type:"button",className:"nav-tab "+(e===n.id?"is-active":""),"aria-current":e===n.id?"page":void 0,onClick:()=>t(n.id)},n.label))),(0,a.createElement)("div",{className:"nav-actions"},(0,a.createElement)("a",{className:"icon-button",href:"https://github.com/SamanLabs/Saman-Security",target:"_blank",rel:"noreferrer","aria-label":"Open GitHub repository"},(0,a.createElement)("svg",{viewBox:"0 0 24 24",role:"img",focusable:"false"},(0,a.createElement)("path",{d:"M12 2C6.5 2 2 6.6 2 12.3c0 4.6 2.9 8.5 6.9 9.9.5.1.7-.2.7-.5v-1.9c-2.8.6-3.3-1.2-3.3-1.2-.5-1.2-1.2-1.5-1.2-1.5-1-.7.1-.7.1-.7 1.1.1 1.7 1.2 1.7 1.2 1 .1.7 1.7 2.6 1.2.1-.8.4-1.2.7-1.5-2.2-.2-4.5-1.2-4.5-5.2 0-1.1.4-2 1-2.7-.1-.2-.4-1.3.1-2.7 0 0 .8-.2 2.7 1a9.2 9.2 0 0 1 4.9 0c1.9-1.2 2.7-1 2.7-1 .5 1.4.2 2.5.1 2.7.6.7 1 1.6 1 2.7 0 4-2.3 5-4.5 5.2.4.3.8 1 .8 2.1v3c0 .3.2.6.7.5 4-1.4 6.9-5.3 6.9-9.9C22 6.6 17.5 2 12 2z"}))))),s=window.wp.apiFetch;var c=e.n(s);const r={security_posture:{score:0,label:"Unknown",enabled:0,total:0,pending:0},recent_activity:{blocked_last_7_days:0,total_last_7_days:0,spark:[],trend:"steady"},scanner:{status:"idle",progress:0,last_scan:"",issues_count:0},firewall:{blocklist_count:0,allowlist_count:0,active_rules:0,blocked_countries:0},notifications:{recipient_email:"",alerts_enabled:0,weekly_summary_enabled:!1},general:{ip_anonymization:!1,log_retention_days:0}},i=()=>{const[e,n]=(0,t.useState)(r),[l,s]=(0,t.useState)(!0),[i,o]=(0,t.useState)(!1),[m,d]=(0,t.useState)(""),u=(0,t.useCallback)(async()=>{s(!0),d("");try{const e=await c()({path:"/wp-security-pilot/v1/dashboard/summary"});n({...r,...e,security_posture:{...r.security_posture,...e?.security_posture||{}},recent_activity:{...r.recent_activity,...e?.recent_activity||{}},scanner:{...r.scanner,...e?.scanner||{}},firewall:{...r.firewall,...e?.firewall||{}},notifications:{...r.notifications,...e?.notifications||{}},general:{...r.general,...e?.general||{}}})}catch(e){d(e?.message||"Unable to load dashboard data.")}finally{s(!1)}},[]);(0,t.useEffect)(()=>{u()},[u]);const p=e.security_posture.score>=85?"success":e.security_posture.score>=70?"warning":"danger",g="running"===e.scanner.status?"warning":e.scanner.issues_count>0?"danger":"success",E=(0,t.useMemo)(()=>{const a=Array.isArray(e.recent_activity.spark)?e.recent_activity.spark:[],t=Math.max(1,...a);return(a.length>=7?a.slice(a.length-7):Array(7-a.length).fill(0).concat(a)).map(e=>Math.max(12,Math.round(e/t*90)))},[e.recent_activity.spark]);return(0,a.createElement)("div",{className:"page"},(0,a.createElement)("div",{className:"page-header"},(0,a.createElement)("div",null,(0,a.createElement)("h1",null,"Dashboard"),(0,a.createElement)("p",null,"Security posture, recent activity, and scanner status at a glance.")),(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{if("running"!==e.scanner.status){o(!0),d("");try{await c()({path:"/wp-security-pilot/v1/scanner/start",method:"POST"}),await u()}catch(e){d(e?.message||"Unable to start a quick scan.")}finally{o(!1)}}},disabled:i||"running"===e.scanner.status},"running"===e.scanner.status?"Scan Running":i?"Starting...":"Run Quick Scan")),m?(0,a.createElement)("p",{className:"form-error"},m):null,(0,a.createElement)("div",{className:"card-grid"},(0,a.createElement)("div",{className:"card"},(0,a.createElement)("div",{className:"card-header"},(0,a.createElement)("h3",null,"Security Posture"),(0,a.createElement)("span",{className:`pill ${p}`},e.security_posture.score,"% Secure")),(0,a.createElement)("div",{className:"gauge",style:{"--value":e.security_posture.score}},(0,a.createElement)("div",{className:"gauge-center"},(0,a.createElement)("div",{className:"gauge-value"},e.security_posture.score,"%"),(0,a.createElement)("div",{className:"gauge-label"},e.security_posture.label))),(0,a.createElement)("p",{className:"card-note"},e.security_posture.pending," hardening rules pending.")),(0,a.createElement)("div",{className:"card"},(0,a.createElement)("div",{className:"card-header"},(0,a.createElement)("h3",null,"Recent Activity"),(0,a.createElement)("span",{className:"pill warning"},"7 days")),(0,a.createElement)("div",{className:"spark-bars","aria-hidden":"true"},E.map((e,t)=>(0,a.createElement)("span",{key:`spark-${t}`,style:{height:`${e}%`}}))),(0,a.createElement)("p",{className:"card-note"},e.recent_activity.blocked_last_7_days," blocked attacks, trending ",e.recent_activity.trend,".")),(0,a.createElement)("div",{className:"card"},(0,a.createElement)("div",{className:"card-header"},(0,a.createElement)("h3",null,"Scanner Status"),(0,a.createElement)("span",{className:`pill ${g}`},e.scanner.status)),(0,a.createElement)("div",{className:"status-row"},(0,a.createElement)("span",{className:`status-dot ${g}`,"aria-hidden":"true"}),(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"status-title"},e.scanner.issues_count>0?"Issues detected":"All clear"),(0,a.createElement)("div",{className:"status-subtitle"},"Last scan: ",(e=>{if(!e)return"No scans yet";const a=e.includes("T")?e:e.replace(" ","T"),t=new Date(a);return Number.isNaN(t.getTime())?e:t.toLocaleString()})(e.scanner.last_scan)))),(0,a.createElement)("p",{className:"card-note"},e.scanner.issues_count," issues found."),"running"===e.scanner.status?(0,a.createElement)("div",{className:"progress-bar compact"},(0,a.createElement)("span",{style:{width:`${e.scanner.progress}%`}})):null),(0,a.createElement)("div",{className:"card"},(0,a.createElement)("div",{className:"card-header"},(0,a.createElement)("h3",null,"Firewall Overview"),(0,a.createElement)("span",{className:"pill"},"Live")),(0,a.createElement)("div",{className:"stat-list"},(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Blocklist IPs"),(0,a.createElement)("strong",null,e.firewall.blocklist_count)),(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Allowlist IPs"),(0,a.createElement)("strong",null,e.firewall.allowlist_count)),(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Active Rules"),(0,a.createElement)("strong",null,e.firewall.active_rules)),(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Geo Blocks"),(0,a.createElement)("strong",null,e.firewall.blocked_countries))),(0,a.createElement)("p",{className:"card-note"},"Auto-block rules are active when rate limits are exceeded.")),(0,a.createElement)("div",{className:"card"},(0,a.createElement)("div",{className:"card-header"},(0,a.createElement)("h3",null,"Notifications"),(0,a.createElement)("span",{className:"pill"},"Configured")),(0,a.createElement)("div",{className:"stat-list"},(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Recipient"),(0,a.createElement)("strong",null,e.notifications.recipient_email||"Admin Email")),(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Alerts Enabled"),(0,a.createElement)("strong",null,e.notifications.alerts_enabled)),(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Weekly Summary"),(0,a.createElement)("strong",null,e.notifications.weekly_summary_enabled?"On":"Off")),(0,a.createElement)("div",{className:"stat-item"},(0,a.createElement)("span",{className:"muted"},"Log Retention"),(0,a.createElement)("strong",null,e.general.log_retention_days," days"))),(0,a.createElement)("p",{className:"card-note"},"IP anonymization ",e.general.ip_anonymization?"enabled":"disabled"," for logs."))),l?(0,a.createElement)("p",{className:"muted"},"Refreshing dashboard data..."):null)},o=({tabs:e,activeTab:t,onChange:n,ariaLabel:l})=>(0,a.createElement)("div",{className:"sub-tabs",role:"tablist","aria-label":l},e.map(e=>(0,a.createElement)("button",{key:e.id,type:"button",role:"tab",className:"sub-tab "+(t===e.id?"is-active":""),"aria-selected":t===e.id,onClick:()=>n(e.id)},e.label))),m=(e,a,t)=>{if("undefined"==typeof window)return a;const n=new URL(window.location.href).searchParams.get(t);return n&&e.some(e=>e.id===n)?n:a},d=({tabs:e,defaultTab:t,paramName:n="tab"})=>{const[l,s]=(0,a.useState)(()=>m(e,t,n));return(0,a.useEffect)(()=>{const a=()=>{s(m(e,t,n))};return window.addEventListener("popstate",a),()=>window.removeEventListener("popstate",a)},[e,t,n]),[l,a=>{if(!e.some(e=>e.id===a))return;if(s(a),"undefined"==typeof window)return;const t=new URL(window.location.href);t.searchParams.set(n,a),window.history.replaceState({},"",t.toString())}]},u=[{id:"traffic",label:"Traffic Rules"},{id:"ip",label:"IP Management"},{id:"geo",label:"Geo-Blocking"}],p=[{value:"GET",label:"Query String (GET)"},{value:"POST",label:"Form Body (POST)"},{value:"COOKIE",label:"Cookies"},{value:"USER_AGENT",label:"User Agent"},{value:"URL",label:"Request URL"}],g=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BQ",name:"Bonaire, Sint Eustatius and Saba"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"BN",name:"Brunei"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"CV",name:"Cabo Verde"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CD",name:"Congo, Democratic Republic of the"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"CI",name:"Cote d'Ivoire"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Curacao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czechia"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands (Malvinas)"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard Island and McDonald Islands"},{code:"VA",name:"Holy See"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KP",name:"Korea, North"},{code:"KR",name:"Korea, South"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestine"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RE",name:"Reunion"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"BL",name:"Saint Barthelemy"},{code:"SH",name:"Saint Helena, Ascension and Tristan da Cunha"},{code:"KN",name:"Saint Kitts and Nevis"},{code:"LC",name:"Saint Lucia"},{code:"MF",name:"Saint Martin (French part)"},{code:"PM",name:"Saint Pierre and Miquelon"},{code:"VC",name:"Saint Vincent and the Grenadines"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten (Dutch part)"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard and Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad and Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks and Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"UM",name:"United States Minor Outlying Islands"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"VG",name:"Virgin Islands (British)"},{code:"VI",name:"Virgin Islands (US)"},{code:"WF",name:"Wallis and Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"}],E=()=>{const[e,n]=d({tabs:u,defaultTab:"ip"}),[l,s]=(0,t.useState)([]),[r,i]=(0,t.useState)([]),[m,E]=(0,t.useState)("block"),[h,b]=(0,t.useState)(!0),[y,v]=(0,t.useState)(""),[N,w]=(0,t.useState)(""),[f,k]=(0,t.useState)(""),[_,S]=(0,t.useState)(!1),[C,A]=(0,t.useState)(null),[P,x]=(0,t.useState)([]),[I,M]=(0,t.useState)(!0),[T,L]=(0,t.useState)(""),[R,B]=(0,t.useState)(!1),[U,F]=(0,t.useState)(null),[G,D]=(0,t.useState)({description:"",target_area:"GET",pattern:""}),[O,H]=(0,t.useState)([]),[V,W]=(0,t.useState)(!0),[z,K]=(0,t.useState)(!1),[$,q]=(0,t.useState)(""),j=(0,t.useMemo)(()=>[...g].sort((e,a)=>e.name.localeCompare(a.name)),[]),Z=(0,t.useCallback)(async()=>{b(!0),k("");try{const[e,a]=await Promise.all([c()({path:"/wp-security-pilot/v1/firewall/ips?list=block"}),c()({path:"/wp-security-pilot/v1/firewall/ips?list=allow"})]);s(Array.isArray(e)?e:[]),i(Array.isArray(a)?a:[])}catch(e){k(e?.message||"Unable to load IP lists.")}finally{b(!1)}},[]),J=(0,t.useCallback)(async()=>{M(!0),L("");try{const e=await c()({path:"/wp-security-pilot/v1/firewall/rules"});x(Array.isArray(e)?e:[])}catch(e){L(e?.message||"Unable to load firewall rules.")}finally{M(!1)}},[]),Y=(0,t.useCallback)(async()=>{W(!0),q("");try{const e=await c()({path:"/wp-security-pilot/v1/firewall/countries"});H(Array.isArray(e)?e:[])}catch(e){q(e?.message||"Unable to load blocked countries.")}finally{W(!1)}},[]);(0,t.useEffect)(()=>{Z(),J(),Y()},[Z,J,Y]);const Q=e=>{if(!e)return"—";const a=e.includes("T")?e:e.replace(" ","T"),t=new Date(a);return Number.isNaN(t.getTime())?e:t.toLocaleString()},X=async e=>{A(e),k("");try{await c()({path:`/wp-security-pilot/v1/firewall/ips/${e}`,method:"DELETE"}),await Z()}catch(e){k(e?.message||"Unable to remove this IP address.")}finally{A(null)}};return(0,a.createElement)("div",{className:"page"},(0,a.createElement)("div",{className:"page-header"},(0,a.createElement)("div",null,(0,a.createElement)("h1",null,"Firewall"),(0,a.createElement)("p",null,"Inspect incoming traffic, manage IP access, and apply geo rules.")),(0,a.createElement)("button",{type:"button",className:"button ghost"},"Review Rule Sets")),(0,a.createElement)(o,{tabs:u,activeTab:e,onChange:n,ariaLabel:"Firewall sections"}),(0,a.createElement)("section",{className:"panel"},"ip"===e?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"table-toolbar"},(0,a.createElement)("div",null,(0,a.createElement)("h3",null,"IP Management"),(0,a.createElement)("p",{className:"muted"},"Track blocked and trusted addresses.")),(0,a.createElement)("div",{className:"inline-form"},(0,a.createElement)("input",{type:"text",placeholder:"IP Address",value:y,onChange:e=>v(e.target.value),disabled:_}),(0,a.createElement)("input",{type:"text",placeholder:"Reason",value:N,onChange:e=>w(e.target.value),disabled:_}),(0,a.createElement)("select",{value:m,onChange:e=>E(e.target.value),disabled:_},(0,a.createElement)("option",{value:"block"},"Blocklist"),(0,a.createElement)("option",{value:"allow"},"Allowlist")),(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{if(y.trim()){S(!0),k("");try{await c()({path:"/wp-security-pilot/v1/firewall/ips",method:"POST",data:{ip:y.trim(),reason:N.trim(),list_type:m}}),v(""),w(""),await Z()}catch(e){k(e?.message||"Unable to save this IP address.")}finally{S(!1)}}else k("Enter an IP address.")},disabled:_},_?"Saving...":"Add to "+("allow"===m?"Allowlist":"Blocklist")),f?(0,a.createElement)("p",{className:"form-error"},f):null)),(0,a.createElement)("div",null,(0,a.createElement)("h4",null,"Blocked IPs"),(0,a.createElement)("table",{className:"data-table"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,"IP Address"),(0,a.createElement)("th",null,"Reason"),(0,a.createElement)("th",null,"Date Added"),(0,a.createElement)("th",null,"Action"))),(0,a.createElement)("tbody",null,h?(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"Loading blocked IPs...")):l.length?l.map(e=>(0,a.createElement)("tr",{key:e.id},(0,a.createElement)("td",null,e.ip_address),(0,a.createElement)("td",null,e.reason||"—"),(0,a.createElement)("td",null,Q(e.created_at)),(0,a.createElement)("td",null,(0,a.createElement)("button",{type:"button",className:"link-button",onClick:()=>X(e.id),disabled:C===e.id},C===e.id?"Removing...":"Remove")))):(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"No blocked IPs yet."))))),(0,a.createElement)("div",null,(0,a.createElement)("h4",null,"Allowed IPs"),(0,a.createElement)("table",{className:"data-table"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,"IP Address"),(0,a.createElement)("th",null,"Reason"),(0,a.createElement)("th",null,"Date Added"),(0,a.createElement)("th",null,"Action"))),(0,a.createElement)("tbody",null,h?(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"Loading allowed IPs...")):r.length?r.map(e=>(0,a.createElement)("tr",{key:e.id},(0,a.createElement)("td",null,e.ip_address),(0,a.createElement)("td",null,e.reason||"—"),(0,a.createElement)("td",null,Q(e.created_at)),(0,a.createElement)("td",null,(0,a.createElement)("button",{type:"button",className:"link-button",onClick:()=>X(e.id),disabled:C===e.id},C===e.id?"Removing...":"Remove")))):(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"No allowed IPs yet.")))))):null,"traffic"===e?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"table-toolbar"},(0,a.createElement)("div",null,(0,a.createElement)("h3",null,"Traffic Rules"),(0,a.createElement)("p",{className:"muted"},"Inspect incoming requests for malicious patterns.")),(0,a.createElement)("div",{className:"inline-form"},(0,a.createElement)("input",{type:"text",placeholder:"Rule description",value:G.description,onChange:e=>D(a=>({...a,description:e.target.value})),disabled:R}),(0,a.createElement)("select",{value:G.target_area,onChange:e=>D(a=>({...a,target_area:e.target.value})),disabled:R},p.map(e=>(0,a.createElement)("option",{key:e.value,value:e.value},e.label))),(0,a.createElement)("input",{type:"text",placeholder:"Regex pattern",value:G.pattern,onChange:e=>D(a=>({...a,pattern:e.target.value})),disabled:R}),(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{if(G.description.trim()&&G.pattern.trim()){B(!0),L("");try{await c()({path:"/wp-security-pilot/v1/firewall/rules",method:"POST",data:{description:G.description.trim(),target_area:G.target_area,pattern:G.pattern.trim()}}),D({description:"",target_area:"GET",pattern:""}),await J()}catch(e){L(e?.message||"Unable to create firewall rule.")}finally{B(!1)}}else L("Provide a description and regex pattern for the rule.")},disabled:R},R?"Adding...":"Add Rule"),T?(0,a.createElement)("p",{className:"form-error"},T):null)),(0,a.createElement)("table",{className:"data-table"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,"Rule"),(0,a.createElement)("th",null,"Target"),(0,a.createElement)("th",null,"Pattern"),(0,a.createElement)("th",null,"Status"))),(0,a.createElement)("tbody",null,I?(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"Loading firewall rules...")):P.length?P.map(e=>(0,a.createElement)("tr",{key:e.id},(0,a.createElement)("td",null,e.description),(0,a.createElement)("td",null,e.target_area),(0,a.createElement)("td",null,(0,a.createElement)("span",{className:"code"},e.pattern)),(0,a.createElement)("td",null,(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{type:"checkbox",checked:!!e.is_active,onChange:()=>(async e=>{F(e.id),L("");try{await c()({path:`/wp-security-pilot/v1/firewall/rules/${e.id}`,method:"PUT",data:{is_active:!e.is_active}}),await J()}catch(e){L(e?.message||"Unable to update rule status.")}finally{F(null)}})(e),disabled:U===e.id}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},e.is_active?"Active":"Paused"))))):(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"No rules available yet."))))):null,"geo"===e?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",null,(0,a.createElement)("h3",null,"Geo-Blocking"),(0,a.createElement)("p",{className:"muted"},"Block traffic based on country of origin.")),(0,a.createElement)("div",{className:"settings-form"},(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"blocked-countries"},"Blocked Countries"),(0,a.createElement)("p",{className:"settings-help"},"Select the countries to block from accessing your site.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("select",{id:"blocked-countries",multiple:!0,value:O,onChange:e=>{const a=Array.from(e.target.selectedOptions).map(e=>e.value);H(a)},disabled:V||z},j.map(e=>(0,a.createElement)("option",{key:e.code,value:e.code},e.name," (",e.code,")"))),(0,a.createElement)("p",{className:"muted"},O.length," countries blocked."))),(0,a.createElement)("div",{className:"form-footer"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{K(!0),q("");try{await c()({path:"/wp-security-pilot/v1/firewall/countries",method:"POST",data:{countries:O}})}catch(e){q(e?.message||"Unable to save blocked countries.")}finally{K(!1)}},disabled:z},z?"Saving...":"Save Geo Rules"),$?(0,a.createElement)("p",{className:"form-error"},$):null))):null))},h=[{id:"general",label:"General Hardening"},{id:"rest",label:"REST API"},{id:"passwords",label:"Password Policy"},{id:"export",label:"Export Config"}],b={general:{xmlrpc_mode:"disable",disable_file_editor:!0,limit_login_attempts:3,hide_wp_version:!0},rest:{access:"authenticated",allowed_roles:["administrator"],allowlist:[]},passwords:{min_length:12,require_upper:!0,require_lower:!0,require_number:!0,require_special:!1,block_common:!0},updated_at:""},y=()=>{const[e,n]=d({tabs:h,defaultTab:"general"}),[l,s]=(0,t.useState)(b),[r,i]=(0,t.useState)(""),[m,u]=(0,t.useState)(""),[p,g]=(0,t.useState)(!0),[E,y]=(0,t.useState)(!1),[v,N]=(0,t.useState)(!1),[w,f]=(0,t.useState)(""),k=(0,t.useCallback)(async()=>{g(!0),f("");try{const e=await c()({path:"/wp-security-pilot/v1/hardening"}),a={...b,...e,general:{...b.general,...e?.general||{}},rest:{...b.rest,...e?.rest||{}},passwords:{...b.passwords,...e?.passwords||{}}};s(a),i((a.rest.allowed_roles||[]).join(", ")),u((a.rest.allowlist||[]).join(", "))}catch(e){f(e?.message||"Unable to load hardening settings.")}finally{g(!1)}},[]);(0,t.useEffect)(()=>{k()},[k]);const _=(e,a)=>{s(t=>({...t,general:{...t.general,[e]:a}}))},S=(e,a)=>{s(t=>({...t,rest:{...t.rest,[e]:a}}))},C=(e,a)=>{s(t=>({...t,passwords:{...t.passwords,[e]:a}}))},A=async e=>{y(!0),f("");const a=e||{...l,rest:{...l.rest,allowed_roles:r.split(",").map(e=>e.trim()).filter(Boolean),allowlist:m.split(",").map(e=>e.trim()).filter(Boolean)}};try{const e=await c()({path:"/wp-security-pilot/v1/hardening",method:"POST",data:a}),t={...b,...e,general:{...b.general,...e?.general||{}},rest:{...b.rest,...e?.rest||{}},passwords:{...b.passwords,...e?.passwords||{}}};s(t),i((t.rest.allowed_roles||[]).join(", ")),u((t.rest.allowlist||[]).join(", "))}catch(e){f(e?.message||"Unable to save hardening settings.")}finally{y(!1)}},P=e=>{if(!e)return"Not saved yet";const a=e.includes("T")?e:e.replace(" ","T"),t=new Date(a);return Number.isNaN(t.getTime())?e:t.toLocaleString()},x=(0,t.useMemo)(()=>[{label:"File editor disabled",enabled:l.general.disable_file_editor},{label:"XML-RPC blocked",enabled:"disable"===l.general.xmlrpc_mode||"pingbacks"===l.general.xmlrpc_mode},{label:"Login attempts limited",enabled:l.general.limit_login_attempts>0},{label:"WP version hidden",enabled:l.general.hide_wp_version},{label:"REST API limited",enabled:"open"!==l.rest.access},{label:"Password policy enforced",enabled:l.passwords.min_length>=8||l.passwords.block_common}],[l]),I=x.filter(e=>e.enabled).length;return(0,a.createElement)("div",{className:"page"},(0,a.createElement)("div",{className:"page-header"},(0,a.createElement)("div",null,(0,a.createElement)("h1",null,"Hardening"),(0,a.createElement)("p",null,"Lock down core WordPress settings and enforce best practices.")),(0,a.createElement)("button",{type:"button",className:"button ghost"},"View Recommendations")),(0,a.createElement)(o,{tabs:h,activeTab:e,onChange:n,ariaLabel:"Hardening sections"}),(0,a.createElement)("div",{className:"page-body two-column"},(0,a.createElement)("section",{className:"panel"},"general"===e?(0,a.createElement)("form",{className:"settings-form"},(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"xmlrpc"},"XML-RPC Access"),(0,a.createElement)("p",{className:"settings-help"},"Control legacy XML-RPC endpoints and pingbacks.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("div",{className:"radio-group"},(0,a.createElement)("label",null,(0,a.createElement)("input",{type:"radio",name:"xmlrpc",value:"disable",checked:"disable"===l.general.xmlrpc_mode,onChange:()=>_("xmlrpc_mode","disable"),disabled:p||E}),"Disable completely"),(0,a.createElement)("label",null,(0,a.createElement)("input",{type:"radio",name:"xmlrpc",value:"pingbacks",checked:"pingbacks"===l.general.xmlrpc_mode,onChange:()=>_("xmlrpc_mode","pingbacks"),disabled:p||E}),"Disable pingbacks only"),(0,a.createElement)("label",null,(0,a.createElement)("input",{type:"radio",name:"xmlrpc",value:"allow",checked:"allow"===l.general.xmlrpc_mode,onChange:()=>_("xmlrpc_mode","allow"),disabled:p||E}),"Allow all")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"file-editor"},"File Editor in Admin"),(0,a.createElement)("p",{className:"settings-help"},"Disables the Theme/Plugin file editor to prevent code injection.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"file-editor",type:"checkbox",checked:l.general.disable_file_editor,onChange:e=>_("disable_file_editor",e.target.checked),disabled:p||E}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},"Protected")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"login-attempts"},"Limit Login Attempts"),(0,a.createElement)("p",{className:"settings-help"},"Block IPs after repeated failed logins.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"login-attempts",type:"number",min:"0",value:l.general.limit_login_attempts,onChange:e=>_("limit_login_attempts",Number(e.target.value)),disabled:p||E}))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"hide-version"},"Obscurity"),(0,a.createElement)("p",{className:"settings-help"},"Remove the WordPress version from source code and feeds.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{id:"hide-version",type:"checkbox",checked:l.general.hide_wp_version,onChange:e=>_("hide_wp_version",e.target.checked),disabled:p||E}),"Hide WP version"))),(0,a.createElement)("div",{className:"form-footer"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:()=>A(),disabled:p||E},E?"Saving...":"Save Hardening Rules"),(0,a.createElement)("span",{className:"muted"},"Last saved ",P(l.updated_at),"."),w?(0,a.createElement)("p",{className:"form-error"},w):null)):null,"rest"===e?(0,a.createElement)("form",{className:"settings-form"},(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"rest-access"},"REST API Access"),(0,a.createElement)("p",{className:"settings-help"},"Define who can access REST API endpoints.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("div",{className:"radio-group"},(0,a.createElement)("label",null,(0,a.createElement)("input",{type:"radio",name:"rest-access",value:"open",checked:"open"===l.rest.access,onChange:()=>S("access","open"),disabled:p||E}),"Allow public access"),(0,a.createElement)("label",null,(0,a.createElement)("input",{type:"radio",name:"rest-access",value:"authenticated",checked:"authenticated"===l.rest.access,onChange:()=>S("access","authenticated"),disabled:p||E}),"Authenticated users only"),(0,a.createElement)("label",null,(0,a.createElement)("input",{type:"radio",name:"rest-access",value:"restricted",checked:"restricted"===l.rest.access,onChange:()=>S("access","restricted"),disabled:p||E}),"Restricted by role")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"rest-roles"},"Allowed Roles"),(0,a.createElement)("p",{className:"settings-help"},"Comma-separated roles allowed when access is restricted.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"rest-roles",type:"text",placeholder:"administrator, editor",value:r,onChange:e=>i(e.target.value),disabled:p||E||"restricted"!==l.rest.access}))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"rest-allowlist"},"Allowlisted Routes"),(0,a.createElement)("p",{className:"settings-help"},"Comma-separated REST route prefixes that stay public.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"rest-allowlist",type:"text",placeholder:"/wp/v2/, /oembed/1.0/",value:m,onChange:e=>u(e.target.value),disabled:p||E}))),(0,a.createElement)("div",{className:"form-footer"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:()=>A(),disabled:p||E},E?"Saving...":"Save REST API Rules"),(0,a.createElement)("span",{className:"muted"},"Last saved ",P(l.updated_at),"."),w?(0,a.createElement)("p",{className:"form-error"},w):null)):null,"passwords"===e?(0,a.createElement)("form",{className:"settings-form"},(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"min-length"},"Minimum Password Length"),(0,a.createElement)("p",{className:"settings-help"},"Enforce a stronger baseline for all accounts.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"min-length",type:"number",min:"6",value:l.passwords.min_length,onChange:e=>C("min_length",Number(e.target.value)),disabled:p||E}))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",null,"Complexity Requirements"),(0,a.createElement)("p",{className:"settings-help"},"Require specific character types in passwords.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("div",{className:"checkbox-group"},(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:l.passwords.require_upper,onChange:e=>C("require_upper",e.target.checked),disabled:p||E}),"Uppercase letters"),(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:l.passwords.require_lower,onChange:e=>C("require_lower",e.target.checked),disabled:p||E}),"Lowercase letters"),(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:l.passwords.require_number,onChange:e=>C("require_number",e.target.checked),disabled:p||E}),"Numbers"),(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:l.passwords.require_special,onChange:e=>C("require_special",e.target.checked),disabled:p||E}),"Special characters")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"block-common"},"Common Passwords"),(0,a.createElement)("p",{className:"settings-help"},"Reject commonly used passwords and obvious patterns.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"block-common",type:"checkbox",checked:l.passwords.block_common,onChange:e=>C("block_common",e.target.checked),disabled:p||E}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},"Blocked")))),(0,a.createElement)("div",{className:"form-footer"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:()=>A(),disabled:p||E},E?"Saving...":"Save Password Policy"),(0,a.createElement)("span",{className:"muted"},"Last saved ",P(l.updated_at),"."),w?(0,a.createElement)("p",{className:"form-error"},w):null)):null,"export"===e?(0,a.createElement)("div",{className:"settings-form"},(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",null,"Export Configuration"),(0,a.createElement)("p",{className:"settings-help"},"Download your hardening settings for backup or migration.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{N(!0),f("");try{const e=await c()({path:"/wp-security-pilot/v1/hardening/export",parse:!1}),a=await e.blob(),t=window.URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download="wp-security-pilot-hardening.json",document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)}catch(e){f(e?.message||"Unable to export hardening settings.")}finally{N(!1)}},disabled:v},v?"Exporting...":"Export Config"))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",null,"Configuration Preview"),(0,a.createElement)("p",{className:"settings-help"},"Review what will be exported.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("pre",{className:"config-preview"},JSON.stringify(l,null,2)))),w?(0,a.createElement)("p",{className:"form-error"},w):null):(0,a.createElement)("div",{className:"empty-state"},(0,a.createElement)("h3",null,h.find(a=>a.id===e).label),(0,a.createElement)("p",null,"Configure advanced policies for this area. Connect data via the REST API when ready."),(0,a.createElement)("button",{type:"button",className:"button ghost"},"Add Configuration"))),(0,a.createElement)("aside",{className:"side-panel"},(0,a.createElement)("div",{className:"side-card"},(0,a.createElement)("h3",null,"Hardening Status"),(0,a.createElement)("p",{className:"muted"},I," of ",x.length," protections enabled."),(0,a.createElement)("ul",{className:"status-list"},x.map(e=>(0,a.createElement)("li",{key:e.label},(0,a.createElement)("span",{className:"status-dot "+(e.enabled?"success":"warning")}),e.label)))),(0,a.createElement)("div",{className:"side-card highlight"},(0,a.createElement)("h3",null,"Quick Wins"),(0,a.createElement)("p",{className:"muted"},"Enable two more rules to reach 90% hardening."),(0,a.createElement)("button",{type:"button",className:"button primary",onClick:()=>{const e={...b,updated_at:l.updated_at};s(e),i(b.rest.allowed_roles.join(", ")),u(b.rest.allowlist.join(", ")),A(e)},disabled:E||p},"Apply Defaults")))))},v=[{id:"scan",label:"Scan Now"},{id:"schedule",label:"Schedule"},{id:"ignore",label:"Ignore List"}],N={status:"idle",progress:0,message:"",results:[],started_at:"",completed_at:""},w={enabled:!1,frequency:"daily",time:"02:00"},f=()=>{const[e,n]=d({tabs:v,defaultTab:"scan"}),[l,s]=(0,t.useState)(N),[r,i]=(0,t.useState)(null),[m,u]=(0,t.useState)(!1),[p,g]=(0,t.useState)(!1),[E,h]=(0,t.useState)(""),[b,y]=(0,t.useState)(w),[f,k]=(0,t.useState)(!1),[_,S]=(0,t.useState)(""),[C,A]=(0,t.useState)(""),[P,x]=(0,t.useState)(!1),[I,M]=(0,t.useState)(""),T=(0,t.useCallback)(async()=>{try{const e=await c()({path:"/wp-security-pilot/v1/scanner/status"});e?.id&&i(e.id),s({...N,...e,results:Array.isArray(e?.results)?e.results:[]})}catch(e){h(e?.message||"Unable to load scan status.")}},[]),L=(0,t.useCallback)(async e=>{try{const a=await c()({path:`/wp-security-pilot/v1/scanner/status/${e}`});return s({...N,...a,results:Array.isArray(a?.results)?a.results:[]}),a}catch(e){return h(e?.message||"Unable to refresh scan status."),null}},[]),R=(0,t.useCallback)(async()=>{try{const e=await c()({path:"/wp-security-pilot/v1/scanner/schedule"});y({...w,...e})}catch(e){S(e?.message||"Unable to load schedule settings.")}},[]),B=(0,t.useCallback)(async()=>{try{const e=await c()({path:"/wp-security-pilot/v1/scanner/ignore"}),a=Array.isArray(e)?e:[];A(a.join("\n"))}catch(e){M(e?.message||"Unable to load ignore list.")}},[]);(0,t.useEffect)(()=>{T(),R(),B()},[T,R,B]),(0,t.useEffect)(()=>{if(!r||"running"!==l.status)return;const e=setInterval(()=>{L(r).then(a=>{a&&"running"!==a.status&&clearInterval(e)})},3e3);return()=>clearInterval(e)},[r,l.status,L]);const U="running"===l.status;return(0,a.createElement)("div",{className:"page"},(0,a.createElement)("div",{className:"page-header"},(0,a.createElement)("div",null,(0,a.createElement)("h1",null,"Scanner"),(0,a.createElement)("p",null,"Monitor file integrity, malware signatures, and core checks.")),(0,a.createElement)("button",{type:"button",className:"button ghost"},"View Scan History")),(0,a.createElement)(o,{tabs:v,activeTab:e,onChange:n,ariaLabel:"Scanner sections"}),(0,a.createElement)("section",{className:"panel"},"scan"===e?(0,a.createElement)("div",{className:"scan-layout"},(0,a.createElement)("div",{className:"scan-action"},(0,a.createElement)("h3",null,"Run a manual scan"),(0,a.createElement)("p",{className:"muted"},"Check plugins, themes, and core files for changes."),(0,a.createElement)("div",{className:"inline-form"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{u(!0),h("");try{const e=await c()({path:"/wp-security-pilot/v1/scanner/start",method:"POST"});i(e.job_id),await L(e.job_id)}catch(e){h(e?.message||"Unable to start scan.")}finally{u(!1)}},disabled:U||m},m?"Starting...":"Start New Scan"),(0,a.createElement)("button",{type:"button",className:"button",onClick:async()=>{if(r){g(!0),h("");try{await c()({path:`/wp-security-pilot/v1/scanner/stop/${r}`,method:"POST"}),await L(r)}catch(e){h(e?.message||"Unable to stop scan.")}finally{g(!1)}}},disabled:!U||p},p?"Stopping...":"Stop Scan"),E?(0,a.createElement)("p",{className:"form-error"},E):null)),U&&(0,a.createElement)("div",{className:"scan-progress"},(0,a.createElement)("div",{className:"progress-header"},(0,a.createElement)("span",null,l.message||"Scanning files..."),(0,a.createElement)("span",{className:"muted"},l.progress,"%")),(0,a.createElement)("div",{className:"progress-bar"},(0,a.createElement)("span",{style:{width:`${l.progress}%`}}))),!U&&"idle"!==l.status&&(0,a.createElement)("div",{className:"scan-progress"},(0,a.createElement)("div",{className:"progress-header"},(0,a.createElement)("span",null,l.message||"Scan status updated."),(0,a.createElement)("span",{className:"muted"},l.progress,"%")),(0,a.createElement)("div",{className:"progress-bar"},(0,a.createElement)("span",{style:{width:`${l.progress}%`}}))),(0,a.createElement)("div",{className:"scan-results"},(0,a.createElement)("h3",null,"Latest Results"),l.results.length?(0,a.createElement)("ul",{className:"result-list"},l.results.map(e=>{return(0,a.createElement)("li",{key:`${e.file_path}-${e.created_at}`},(0,a.createElement)("span",{className:"pill "+(t=e.status,"flagged"===t?"danger":"modified"===t?"warning":"success")},e.status),(0,a.createElement)("div",{className:"result-details"},(0,a.createElement)("span",null,e.file_path),e.details?(0,a.createElement)("span",{className:"result-meta"},e.details):null));var t})):(0,a.createElement)("p",{className:"muted"},"No issues detected yet."))):null,"schedule"===e?(0,a.createElement)("form",{className:"settings-form"},(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"scan-schedule"},"Enable Scheduled Scans"),(0,a.createElement)("p",{className:"settings-help"},"Automatically run scans on a recurring schedule.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"scan-schedule",type:"checkbox",checked:b.enabled,onChange:e=>y(a=>({...a,enabled:e.target.checked}))}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},b.enabled?"Enabled":"Disabled")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"scan-frequency"},"Frequency"),(0,a.createElement)("p",{className:"settings-help"},"Choose how often the scan should run.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("select",{id:"scan-frequency",value:b.frequency,onChange:e=>y(a=>({...a,frequency:e.target.value})),disabled:!b.enabled},(0,a.createElement)("option",{value:"daily"},"Daily"),(0,a.createElement)("option",{value:"weekly"},"Weekly")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"scan-time"},"Run Time"),(0,a.createElement)("p",{className:"settings-help"},"Select the local time for scheduled scans.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"scan-time",type:"time",value:b.time,onChange:e=>y(a=>({...a,time:e.target.value})),disabled:!b.enabled}))),(0,a.createElement)("div",{className:"form-footer"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{k(!0),S("");try{const e=await c()({path:"/wp-security-pilot/v1/scanner/schedule",method:"POST",data:b});y({...w,...e})}catch(e){S(e?.message||"Unable to save schedule.")}finally{k(!1)}},disabled:f},f?"Saving...":"Save Schedule"),_?(0,a.createElement)("p",{className:"form-error"},_):null)):null,"ignore"===e?(0,a.createElement)("form",{className:"settings-form"},(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"ignore-patterns"},"Ignore Paths"),(0,a.createElement)("p",{className:"settings-help"},"Add one path or wildcard pattern per line.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("textarea",{id:"ignore-patterns",value:C,onChange:e=>A(e.target.value),placeholder:"wp-content/uploads/*.php"}))),(0,a.createElement)("div",{className:"form-footer"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{x(!0),M("");const e=C.split("\n").map(e=>e.trim()).filter(Boolean);try{const a=await c()({path:"/wp-security-pilot/v1/scanner/ignore",method:"POST",data:{patterns:e}});A((Array.isArray(a)?a:e).join("\n"))}catch(e){M(e?.message||"Unable to save ignore list.")}finally{x(!1)}},disabled:P},P?"Saving...":"Save Ignore List"),I?(0,a.createElement)("p",{className:"form-error"},I):null)):null))},k=()=>{const[e,n]=(0,t.useState)([]),[l,s]=(0,t.useState)(!0),[r,i]=(0,t.useState)(""),[o,m]=(0,t.useState)(""),[d,u]=(0,t.useState)(""),[p,g]=(0,t.useState)(!1),E=(0,t.useCallback)(async e=>{s(!0),u("");const a=e?`?search=${encodeURIComponent(e)}`:"";try{const e=await c()({path:`/wp-security-pilot/v1/activity/logs${a}`});n(Array.isArray(e)?e:[])}catch(e){u(e?.message||"Unable to load activity logs.")}finally{s(!1)}},[]);(0,t.useEffect)(()=>{E(o)},[o,E]);const h=()=>{m(r.trim())};return(0,a.createElement)("div",{className:"page"},(0,a.createElement)("div",{className:"page-header"},(0,a.createElement)("div",null,(0,a.createElement)("h1",null,"Activity Log"),(0,a.createElement)("p",null,"Review recent security events and administrative actions.")),(0,a.createElement)("button",{type:"button",className:"button ghost",onClick:async()=>{g(!0),u("");const e=o?`?search=${encodeURIComponent(o)}`:"";try{const a=await c()({path:`/wp-security-pilot/v1/activity/logs/export${e}`,parse:!1}),t=await a.blob(),n=window.URL.createObjectURL(t),l=document.createElement("a");l.href=n,l.download="wp-security-pilot-activity-log.csv",document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(n)}catch(e){u(e?.message||"Unable to export activity logs.")}finally{g(!1)}},disabled:p},p?"Exporting...":"Export Logs")),(0,a.createElement)("section",{className:"panel"},(0,a.createElement)("div",{className:"table-toolbar"},(0,a.createElement)("div",null,(0,a.createElement)("h3",null,"Recent Events"),(0,a.createElement)("p",{className:"muted"},"Latest 24 hours")),(0,a.createElement)("div",{className:"inline-form"},(0,a.createElement)("input",{type:"text",placeholder:"Filter by user or IP",value:r,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&h()}}),(0,a.createElement)("button",{type:"button",className:"button",onClick:h},"Apply Filter"),d?(0,a.createElement)("p",{className:"form-error"},d):null)),(0,a.createElement)("table",{className:"data-table"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,"Event"),(0,a.createElement)("th",null,"User"),(0,a.createElement)("th",null,"IP"),(0,a.createElement)("th",null,"Time"))),(0,a.createElement)("tbody",null,l?(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"Loading activity logs...")):e.length?e.map(e=>{const t=(e=>{switch(e){case"blocked":return{label:"Blocked",className:"danger"};case"alert":return{label:"Alert",className:"warning"};case"allowed":return{label:"Allowed",className:"success"};default:return{label:"Info",className:""}}})(e.event_type);return(0,a.createElement)("tr",{key:e.id},(0,a.createElement)("td",null,(0,a.createElement)("span",{className:`pill ${t.className}`},t.label)," ",e.event_message),(0,a.createElement)("td",null,e.user_name||"Unknown"),(0,a.createElement)("td",null,e.ip_address||"—"),(0,a.createElement)("td",null,(e=>{if(!e)return"—";const a=e.includes("T")?e:e.replace(" ","T"),t=new Date(a);return Number.isNaN(t.getTime())?e:t.toLocaleString()})(e.created_at)))}):(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:"4"},"No activity recorded yet."))))))},_="wp-security-pilot-matomo",S=(e,a={})=>{"undefined"!=typeof window&&(window._wpspMatomoDisabled=!e,e&&((e={})=>{if("undefined"==typeof window)return;const a=((e={})=>"undefined"==typeof window?e:{...window.wpSecurityPilotSettings?.analytics||{},...e})(e);if(!a.enabled||!a.matomoUrl||!a.siteId)return;if(window._wpspMatomoInitialized)return;window._wpspMatomoInitialized=!0;const t=((e="")=>e?e.endsWith("/")?e:`${e}/`:"")(a.matomoUrl),n=window._paq||[];if(window._paq=n,n.push(["disableCookies"]),n.push(["setTrackerUrl",`${t}matomo.php`]),n.push(["setSiteId",String(a.siteId)]),n.push(["setReferrerUrl",""]),a.siteHash&&n.push(["setUserId",a.siteHash]),a.pluginVersion&&n.push(["setCustomVariable",1,"PluginVersion",a.pluginVersion,"visit"]),!document.getElementById(_)){const e=document.createElement("script");e.id=_,e.async=!0,e.src=`${t}matomo.js`,document.head.appendChild(e)}})({...a,enabled:e}))},C={general:{ip_anonymization:!0,log_retention_days:30,delete_data_on_uninstall:!1},firewall:{ratelimit_threshold:10,ratelimit_period_seconds:60,autoblock_duration_minutes:60},scanner:{scan_intensity:"medium",enable_auto_repair:!1,scan_speed:3,cache_enabled:!0,cache_recheck_days:30},notifications:{recipient_email:"",alerts:{on_firewall_block:!0,on_malware_found:!0,on_core_file_modified:!0,on_admin_login:!1},weekly_summary_enabled:!0},integrations:{slack:{webhook_url:""}},analytics:{enabled:!0},updated_at:""},A=()=>{const[e,n]=(0,t.useState)(C),[l,s]=(0,t.useState)([]),[r,i]=(0,t.useState)(""),[o,m]=(0,t.useState)(""),[d,u]=(0,t.useState)(!0),[p,g]=(0,t.useState)(!1),[E,h]=(0,t.useState)(!1),[b,y]=(0,t.useState)(null),[v,N]=(0,t.useState)(""),[w,f]=(0,t.useState)(""),[k,_]=(0,t.useState)(!0),A=(0,t.useCallback)(async()=>{u(!0),N("");try{const e=await c()({path:"/wp-security-pilot/v1/settings"}),{api_keys:a,...t}=e||{},l={...C,...t,general:{...C.general,...t?.general||{}},firewall:{...C.firewall,...t?.firewall||{}},scanner:{...C.scanner,...t?.scanner||{}},notifications:{...C.notifications,...t?.notifications||{},alerts:{...C.notifications.alerts,...t?.notifications?.alerts||{}}},integrations:{...C.integrations,...t?.integrations||{},slack:{...C.integrations.slack,...t?.integrations?.slack||{}}},analytics:{...C.analytics,...t?.analytics||{}}};n(l),s(Array.isArray(a)?a:[])}catch(e){N(e?.message||"Unable to load settings.")}finally{u(!1)}},[]);(0,t.useEffect)(()=>{A()},[A]);const P=(e,a,t)=>{n(n=>({...n,[e]:{...n[e],[a]:t}}))},x=(e,a)=>{n(t=>({...t,notifications:{...t.notifications,alerts:{...t.notifications.alerts,[e]:a}}}))},I=async a=>{g(!0),N("");try{const t=a||e,r=await c()({path:"/wp-security-pilot/v1/settings",method:"POST",data:t}),{api_keys:i,...o}=r||{},m={...C,...o,general:{...C.general,...o?.general||{}},firewall:{...C.firewall,...o?.firewall||{}},scanner:{...C.scanner,...o?.scanner||{}},notifications:{...C.notifications,...o?.notifications||{},alerts:{...C.notifications.alerts,...o?.notifications?.alerts||{}}},integrations:{...C.integrations,...o?.integrations||{},slack:{...C.integrations.slack,...o?.integrations?.slack||{}}},analytics:{...C.analytics,...o?.analytics||{}}};n(m),s(Array.isArray(i)?i:l)}catch(e){N(e?.message||"Unable to save settings.")}finally{g(!1)}};return(0,a.createElement)("div",{className:"page"},(0,a.createElement)("div",{className:"page-header"},(0,a.createElement)("div",null,(0,a.createElement)("h1",null,"Settings"),(0,a.createElement)("p",null,"Manage notifications, API keys, and global preferences.")),(0,a.createElement)("button",{type:"button",className:"button ghost",onClick:()=>{i(""),n(C),"undefined"!=typeof window&&window.wpSecurityPilotSettings?.analytics&&(window.wpSecurityPilotSettings.analytics.enabled=C.analytics.enabled),S(C.analytics.enabled),I(C)},disabled:p},"Reset Defaults")),(0,a.createElement)("div",{className:"page-body two-column"},(0,a.createElement)("section",{className:"panel"},(0,a.createElement)("div",{className:"analytics-notice"},(0,a.createElement)("div",{className:"analytics-notice__header"},(0,a.createElement)("div",{className:"analytics-notice__icon"},(0,a.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),(0,a.createElement)("path",{d:"M12 16v-4"}),(0,a.createElement)("path",{d:"M12 8h.01"}))),(0,a.createElement)("div",{className:"analytics-notice__content"},(0,a.createElement)("h4",null,"Help Improve WP SEO Pilot"),(0,a.createElement)("p",null,"Share anonymous usage data to help us understand which features are most valuable and improve the plugin for everyone.")),(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{type:"checkbox",checked:e.analytics.enabled,onChange:e=>{const a=e.target.checked;P("analytics","enabled",a),"undefined"!=typeof window&&window.wpSecurityPilotSettings?.analytics&&(window.wpSecurityPilotSettings.analytics.enabled=a),S(a)},disabled:d||p,"aria-label":"Enable analytics"}),(0,a.createElement)("span",{className:"toggle-track"}))),(0,a.createElement)("button",{type:"button",className:"analytics-notice__expand",onClick:()=>_(e=>!e),"aria-expanded":k},k?"Hide details":"Show details",(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("polyline",{points:"6 9 12 15 18 9"}))),k&&(0,a.createElement)("div",{className:"analytics-notice__details"},(0,a.createElement)("div",{className:"analytics-privacy-info"},(0,a.createElement)("h5",null,"What We Collect"),(0,a.createElement)("ul",null,(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("polyline",{points:"20 6 9 17 4 12"})),(0,a.createElement)("span",null,'Feature usage (e.g., "redirect created", "AI title generated")')),(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("polyline",{points:"20 6 9 17 4 12"})),(0,a.createElement)("span",null,"Plugin version number")),(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("polyline",{points:"20 6 9 17 4 12"})),(0,a.createElement)("span",null,"Pages visited within the plugin")),(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("polyline",{points:"20 6 9 17 4 12"})),(0,a.createElement)("span",null,"Anonymized site identifier (hashed URL)"))),(0,a.createElement)("h5",null,"What We Never Collect"),(0,a.createElement)("ul",{className:"analytics-privacy-info__never"},(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.createElement)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),(0,a.createElement)("span",null,"Personal information (names, emails, IP addresses)")),(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.createElement)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),(0,a.createElement)("span",null,"Your content (posts, pages, meta data)")),(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.createElement)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),(0,a.createElement)("span",null,"API keys or credentials")),(0,a.createElement)("li",null,(0,a.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.createElement)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),(0,a.createElement)("span",null,"Your site's URL or domain name"))),(0,a.createElement)("h5",null,"Privacy Measures"),(0,a.createElement)("div",{className:"analytics-privacy-info__measures"},(0,a.createElement)("div",{className:"privacy-measure"},(0,a.createElement)("span",{className:"privacy-measure__icon"},(0,a.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,a.createElement)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"}))),(0,a.createElement)("div",null,(0,a.createElement)("strong",null,"No Cookies"),(0,a.createElement)("span",null,"We don't use any tracking cookies"))),(0,a.createElement)("div",{className:"privacy-measure"},(0,a.createElement)("span",{className:"privacy-measure__icon"},(0,a.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}))),(0,a.createElement)("div",null,(0,a.createElement)("strong",null,"Admin Only"),(0,a.createElement)("span",null,"Only tracks within plugin admin pages"))),(0,a.createElement)("div",{className:"privacy-measure"},(0,a.createElement)("span",{className:"privacy-measure__icon"},(0,a.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.createElement)("line",{x1:"4.93",y1:"4.93",x2:"19.07",y2:"19.07"}))),(0,a.createElement)("div",null,(0,a.createElement)("strong",null,"Opt-out Anytime"),(0,a.createElement)("span",null,"Disable tracking at any time"))),(0,a.createElement)("div",{className:"privacy-measure"},(0,a.createElement)("span",{className:"privacy-measure__icon"},(0,a.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,a.createElement)("path",{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"}))),(0,a.createElement)("div",null,(0,a.createElement)("strong",null,"Self-Hosted"),(0,a.createElement)("span",null,"Analytics on our own Matomo instance")))),(0,a.createElement)("p",{className:"analytics-privacy-info__footer"},"This data helps us prioritize features, fix common issues, and understand how the plugin is used in real-world scenarios. Thank you for helping us improve!")))),(0,a.createElement)("h3",null,"General Settings"),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"ip-anonymization"},"IP Anonymization"),(0,a.createElement)("p",{className:"settings-help"},"Mask the last segment of IPs stored in logs.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"ip-anonymization",type:"checkbox",checked:e.general.ip_anonymization,onChange:e=>P("general","ip_anonymization",e.target.checked),disabled:d||p}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},e.general.ip_anonymization?"Enabled":"Disabled")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"log-retention"},"Log Retention (Days)"),(0,a.createElement)("p",{className:"settings-help"},"Automatically purge logs older than this many days.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"log-retention",type:"number",min:"0",value:e.general.log_retention_days,onChange:e=>P("general","log_retention_days",Number(e.target.value)),disabled:d||p}))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"delete-on-uninstall"},"Delete Data on Uninstall"),(0,a.createElement)("p",{className:"settings-help"},"Remove all plugin data when the plugin is deleted.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"delete-on-uninstall",type:"checkbox",checked:e.general.delete_data_on_uninstall,onChange:e=>P("general","delete_data_on_uninstall",e.target.checked),disabled:d||p}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},e.general.delete_data_on_uninstall?"Enabled":"Disabled")))),(0,a.createElement)("h3",null,"Firewall Controls"),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"rate-threshold"},"Rate Limit Threshold"),(0,a.createElement)("p",{className:"settings-help"},"Number of rule hits before auto-blocking.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"rate-threshold",type:"number",min:"1",value:e.firewall.ratelimit_threshold,onChange:e=>P("firewall","ratelimit_threshold",Number(e.target.value)),disabled:d||p}))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"rate-period"},"Rate Limit Period (Seconds)"),(0,a.createElement)("p",{className:"settings-help"},"Time window used to count repeated hits.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"rate-period",type:"number",min:"10",value:e.firewall.ratelimit_period_seconds,onChange:e=>P("firewall","ratelimit_period_seconds",Number(e.target.value)),disabled:d||p}))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"autoblock-duration"},"Auto-Block Duration (Minutes)"),(0,a.createElement)("p",{className:"settings-help"},"How long auto-blocks remain active.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"autoblock-duration",type:"number",min:"1",value:e.firewall.autoblock_duration_minutes,onChange:e=>P("firewall","autoblock_duration_minutes",Number(e.target.value)),disabled:d||p}))),(0,a.createElement)("h3",null,"Scanner Controls"),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"scan-intensity"},"Scan Intensity"),(0,a.createElement)("p",{className:"settings-help"},"Balance depth of scanning with server load.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("select",{id:"scan-intensity",value:e.scanner.scan_intensity,onChange:e=>P("scanner","scan_intensity",e.target.value),disabled:d||p},(0,a.createElement)("option",{value:"low"},"Low (Core Only)"),(0,a.createElement)("option",{value:"medium"},"Medium (Core + Plugins/Themes)"),(0,a.createElement)("option",{value:"high"},"High (Full Coverage)")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"scan-speed"},"Scan Speed"),(0,a.createElement)("p",{className:"settings-help"},"Control how aggressively the scanner processes files.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"scan-speed",type:"range",min:"1",max:"5",step:"1",value:e.scanner.scan_speed,onChange:e=>P("scanner","scan_speed",Number(e.target.value)),disabled:d||p}),(0,a.createElement)("div",{className:"range-meta"},(0,a.createElement)("span",null,"Slow"),(0,a.createElement)("strong",null,(e=>{switch(Number(e)){case 1:return"Gentle";case 2:return"Balanced";case 4:return"Fast";case 5:return"Turbo";default:return"Standard"}})(e.scanner.scan_speed)),(0,a.createElement)("span",null,"Fast")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"auto-repair"},"Auto Repair Core Files"),(0,a.createElement)("p",{className:"settings-help"},"Automatically restore modified WordPress core files.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"auto-repair",type:"checkbox",checked:e.scanner.enable_auto_repair,onChange:e=>P("scanner","enable_auto_repair",e.target.checked),disabled:d||p}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},e.scanner.enable_auto_repair?"Enabled":"Disabled")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"cache-enabled"},"Skip Unchanged Files"),(0,a.createElement)("p",{className:"settings-help"},"Skip files that have not changed since the last clean scan.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"cache-enabled",type:"checkbox",checked:e.scanner.cache_enabled,onChange:e=>P("scanner","cache_enabled",e.target.checked),disabled:d||p}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},e.scanner.cache_enabled?"Enabled":"Disabled")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"cache-recheck"},"Recheck Unchanged Files (Days)"),(0,a.createElement)("p",{className:"settings-help"},"Force a full re-scan after this many days.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"cache-recheck",type:"number",min:"1",max:"365",value:e.scanner.cache_recheck_days,onChange:e=>P("scanner","cache_recheck_days",Number(e.target.value)),disabled:d||p||!e.scanner.cache_enabled}))),(0,a.createElement)("h3",null,"Notifications"),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"recipient-email"},"Recipient Email"),(0,a.createElement)("p",{className:"settings-help"},"Override the site admin email for alerts.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{id:"recipient-email",type:"text",placeholder:"security-team@example.com",value:e.notifications.recipient_email,onChange:e=>P("notifications","recipient_email",e.target.value),disabled:d||p}))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",null,"Alert Types"),(0,a.createElement)("p",{className:"settings-help"},"Choose which events trigger notifications.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("div",{className:"checkbox-group"},(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:e.notifications.alerts.on_firewall_block,onChange:e=>x("on_firewall_block",e.target.checked),disabled:d||p}),"Firewall blocks"),(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:e.notifications.alerts.on_malware_found,onChange:e=>x("on_malware_found",e.target.checked),disabled:d||p}),"Malware detected"),(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:e.notifications.alerts.on_core_file_modified,onChange:e=>x("on_core_file_modified",e.target.checked),disabled:d||p}),"Core file modified"),(0,a.createElement)("label",{className:"checkbox"},(0,a.createElement)("input",{type:"checkbox",checked:e.notifications.alerts.on_admin_login,onChange:e=>x("on_admin_login",e.target.checked),disabled:d||p}),"Admin login")))),(0,a.createElement)("div",{className:"settings-row"},(0,a.createElement)("div",{className:"settings-label"},(0,a.createElement)("label",{htmlFor:"weekly-summary"},"Weekly Summary"),(0,a.createElement)("p",{className:"settings-help"},"Send a weekly security digest.")),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("label",{className:"toggle"},(0,a.createElement)("input",{id:"weekly-summary",type:"checkbox",checked:e.notifications.weekly_summary_enabled,onChange:e=>P("notifications","weekly_summary_enabled",e.target.checked),disabled:d||p}),(0,a.createElement)("span",{className:"toggle-track"}),(0,a.createElement)("span",{className:"toggle-text"},e.notifications.weekly_summary_enabled?"Enabled":"Disabled")))),(0,a.createElement)("div",{className:"form-footer"},(0,a.createElement)("button",{type:"button",className:"button primary",onClick:()=>I(),disabled:d||p},p?"Saving...":"Save Settings"),(0,a.createElement)("span",{className:"muted"},"Last saved ",(e=>{if(!e)return"Not saved yet";const a=e.includes("T")?e:e.replace(" ","T"),t=new Date(a);return Number.isNaN(t.getTime())?e:t.toLocaleString()})(e.updated_at),"."),v?(0,a.createElement)("p",{className:"form-error"},v):null)),(0,a.createElement)("aside",{className:"side-panel"},(0,a.createElement)("div",{className:"side-card"},(0,a.createElement)("h3",null,"API Keys"),(0,a.createElement)("p",{className:"muted"},"Generate keys to connect external dashboards."),(0,a.createElement)("div",{className:"inline-form"},(0,a.createElement)("input",{type:"text",placeholder:"Key label",value:o,onChange:e=>m(e.target.value),disabled:E}),(0,a.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{h(!0),f("");try{const e=await c()({path:"/wp-security-pilot/v1/settings/api-keys",method:"POST",data:{label:o}});i(e?.key||""),e?.entry?s(a=>[...a,e.entry]):await A(),m("")}catch(e){f(e?.message||"Unable to generate API key.")}finally{h(!1)}},disabled:E},E?"Generating...":"Generate Key")),w?(0,a.createElement)("p",{className:"form-error"},w):null,r?(0,a.createElement)("div",{className:"key-preview"},(0,a.createElement)("span",{className:"muted"},"New Key (copy now):"),(0,a.createElement)("span",{className:"code"},r)):null,(0,a.createElement)("div",{className:"api-key-list"},l.length?l.map(e=>(0,a.createElement)("div",{key:e.key_prefix,className:"api-key-row"},(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"api-key-label"},e.label||"API Key"),(0,a.createElement)("div",{className:"muted"},e.key_prefix)),(0,a.createElement)("button",{type:"button",className:"link-button",onClick:()=>(async e=>{y(e),f("");try{const a=await c()({path:`/wp-security-pilot/v1/settings/api-keys/${e}`,method:"DELETE"});s(Array.isArray(a)?a:[])}catch(e){f(e?.message||"Unable to revoke API key.")}finally{y(null)}})(e.key_prefix),disabled:b===e.key_prefix},b===e.key_prefix?"Revoking...":"Revoke"))):(0,a.createElement)("p",{className:"muted"},"No API keys generated yet."))),(0,a.createElement)("div",{className:"side-card highlight"},(0,a.createElement)("h3",null,"Integrations"),(0,a.createElement)("p",{className:"muted"},"Connect Slack, webhooks, and custom endpoints."),(0,a.createElement)("div",{className:"settings-control"},(0,a.createElement)("input",{type:"text",placeholder:"Slack webhook URL",value:e.integrations.slack.webhook_url,onChange:e=>n(a=>({...a,integrations:{...a.integrations,slack:{...a.integrations.slack,webhook_url:e.target.value}}})),disabled:d||p}))))))},P=({type:e})=>{switch(e){case"security":return(0,a.createElement)("svg",{viewBox:"0 0 24 24",role:"img",focusable:"false"},(0,a.createElement)("path",{d:"M12 2L4 5.4v6.2c0 5.1 3.4 9.7 8 10.4 4.6-.7 8-5.3 8-10.4V5.4L12 2zm0 2.2l6 2.3v5.1c0 4-2.5 7.6-6 8.3-3.5-.7-6-4.3-6-8.3V6.5l6-2.3z"}),(0,a.createElement)("path",{d:"M10.5 12.7l-2-2-1.3 1.3 3.3 3.3 5.3-5.3-1.3-1.3-4 4z"}));case"ai":return(0,a.createElement)("svg",{viewBox:"0 0 24 24",role:"img",focusable:"false"},(0,a.createElement)("path",{d:"M21 10.5h-1.5V9h-2v1.5h-2V9h-2v1.5H12V9h-1.5v3h-2V9H6v3H4.5V9H3v6h1.5v-2.5h2V15H9v-2.5h1.5V15h2v-2.5h2V15h2v-2.5H18V15h1.5v-2.5H21V15h1.5v-6H21v1.5z"}),(0,a.createElement)("circle",{cx:"7.5",cy:"5.5",r:"1.5"}),(0,a.createElement)("circle",{cx:"16.5",cy:"5.5",r:"1.5"}),(0,a.createElement)("circle",{cx:"12",cy:"3",r:"1.5"}),(0,a.createElement)("circle",{cx:"7.5",cy:"18.5",r:"1.5"}),(0,a.createElement)("circle",{cx:"16.5",cy:"18.5",r:"1.5"}),(0,a.createElement)("circle",{cx:"12",cy:"21",r:"1.5"}));case"seo":return(0,a.createElement)("svg",{viewBox:"0 0 24 24",role:"img",focusable:"false"},(0,a.createElement)("path",{d:"M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99l1.5 1.5z"}),(0,a.createElement)("path",{d:"M21 3h-3v2h1.59l-4.09 4.09 1.41 1.41L21 6.41V8h2V3h-2z"}));default:return(0,a.createElement)("svg",{viewBox:"0 0 24 24",role:"img",focusable:"false"},(0,a.createElement)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"}))}},x=()=>{const[e,n]=(0,t.useState)({}),[l,s]=(0,t.useState)(!0),[r,i]=(0,t.useState)(!1),[o,m]=(0,t.useState)({}),[d,u]=(0,t.useState)({}),[p,g]=(0,t.useState)(null);(0,t.useEffect)(()=>{E()},[]);const E=async()=>{try{const e=await c()({path:"/wp-security-pilot/v1/updater/plugins"});n(e)}catch(e){console.error("Failed to load plugins:",e),g({type:"error",message:"Failed to load plugins"})}finally{s(!1)}},h=async(e,a)=>{m(t=>({...t,[e]:a})),g(null);try{const t=await c()({path:`/wp-security-pilot/v1/updater/${a}`,method:"POST",data:{slug:e}});await E(),t.success&&g({type:"success",message:t.message})}catch(e){g({type:"error",message:`Failed to ${a} plugin: ${e.message}`})}finally{m(a=>({...a,[e]:null}))}};return l?(0,a.createElement)("div",{className:"page"},(0,a.createElement)("div",{className:"loading"},"Loading plugins...")):(0,a.createElement)("div",{className:"page"},p&&(0,a.createElement)("div",{className:`notice notice-${p.type}`},(0,a.createElement)("p",null,p.message),(0,a.createElement)("button",{type:"button",className:"notice-dismiss",onClick:()=>g(null)},(0,a.createElement)("span",{className:"screen-reader-text"},"Dismiss"))),(0,a.createElement)("div",{className:"page-header"},(0,a.createElement)("div",null,(0,a.createElement)("h1",null,"Pilot Plugins"),(0,a.createElement)("p",null,"Install and manage plugins from the Pilot ecosystem.")),(0,a.createElement)("button",{type:"button",className:"button ghost",onClick:async()=>{i(!0),g(null);try{await c()({path:"/wp-security-pilot/v1/updater/check",method:"POST"}),await E(),g({type:"success",message:"Update check complete"})}catch(e){console.error("Failed to check updates:",e),g({type:"error",message:"Failed to check for updates"})}finally{i(!1)}},disabled:r},r?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("span",{className:"spinner is-active",style:{margin:0,marginRight:8}}),"Checking..."):"Check for Updates")),(0,a.createElement)("div",{className:"pilot-grid"},Object.entries(e).map(([e,t])=>{const n=t.beta_enabled&&t.beta_available,l=t.update_available&&!n;return(0,a.createElement)("div",{key:e,className:`pilot-card ${t.active?"active":""} ${l?"has-update":""} ${n?"has-beta-update":""}`},(0,a.createElement)("div",{className:"pilot-card-head"},(0,a.createElement)("div",{className:"pilot-card-identity"},(0,a.createElement)("span",{className:`pilot-card-mark ${t.type}`,"aria-hidden":"true"},(0,a.createElement)(P,{type:t.type})),(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"pilot-card-title"},(0,a.createElement)("h3",null,t.name),t.installed&&t.active&&(0,a.createElement)("span",{className:"badge success"},"Active"),t.installed&&!t.active&&(0,a.createElement)("span",{className:"badge"},"Inactive"),!t.installed&&(0,a.createElement)("span",{className:"badge"},"Available"),l&&(0,a.createElement)("span",{className:"badge warning"},"Update"),n&&(0,a.createElement)("span",{className:"badge beta"},"Beta Update")),(0,a.createElement)("p",{className:"pilot-card-version"},t.installed?l?(0,a.createElement)(a.Fragment,null,"v",t.current_version," → v",t.remote_version):n?(0,a.createElement)(a.Fragment,null,"v",t.current_version," → v",t.beta_version):(0,a.createElement)(a.Fragment,null,"v",t.current_version):t.remote_version?(0,a.createElement)(a.Fragment,null,"v",t.remote_version," available"):"Not available")))),(0,a.createElement)("p",{className:"pilot-card-desc"},t.description),t.installed&&(0,a.createElement)("div",{className:"pilot-card-beta"},(0,a.createElement)("label",{className:"beta-toggle"},(0,a.createElement)("input",{type:"checkbox",checked:t.beta_enabled||!1,onChange:()=>(async(e,a)=>{u(a=>({...a,[e]:!0}));try{await c()({path:"/wp-security-pilot/v1/updater/beta",method:"POST",data:{slug:e,enabled:!a}}),await E()}catch(e){g({type:"error",message:"Failed to toggle beta versions"})}finally{u(a=>({...a,[e]:!1}))}})(e,t.beta_enabled),disabled:d[e]}),(0,a.createElement)("span",{className:"beta-toggle-slider"}),(0,a.createElement)("span",{className:"beta-toggle-label"},"Beta versions",t.beta_available&&!t.beta_enabled&&(0,a.createElement)("span",{className:"beta-available-hint"}," (v",t.beta_version," available)")))),(0,a.createElement)("div",{className:"pilot-card-meta"},t.installed?(0,a.createElement)(a.Fragment,null,l&&(0,a.createElement)("button",{type:"button",className:"button warning",onClick:()=>h(e,"update"),disabled:"update"===o[e]},"update"===o[e]?"Updating...":"Update"),n&&(0,a.createElement)("button",{type:"button",className:"button beta",onClick:()=>h(e,"update"),disabled:"update"===o[e]},"update"===o[e]?"Installing...":"Install Beta"),t.active?(0,a.createElement)("button",{type:"button",className:"button secondary",onClick:()=>h(e,"deactivate"),disabled:"deactivate"===o[e]},"Deactivate"):(0,a.createElement)("button",{type:"button",className:"button success",onClick:()=>h(e,"activate"),disabled:"activate"===o[e]},"activate"===o[e]?"Activating...":"Activate")):(0,a.createElement)("button",{type:"button",className:"button primary",onClick:()=>h(e,"install"),disabled:"install"===o[e]||!t.download_url},"install"===o[e]?"Installing...":"Get Plugin"),(0,a.createElement)("a",{href:t.github_url,target:"_blank",rel:"noopener noreferrer",className:"button ghost"},"GitHub")))})))},I={dashboard:"wp-security-pilot-dashboard",firewall:"wp-security-pilot-firewall",scanner:"wp-security-pilot-scanner",hardening:"wp-security-pilot-hardening",activity:"wp-security-pilot-activity",settings:"wp-security-pilot-settings",more:"wp-security-pilot-more"},M=Object.entries(I).reduce((e,[a,t])=>(e[t]=a,e),{}),T=window?.wpSecurityPilotSettings?.initialView||"dashboard";(0,t.render)((0,a.createElement)(({initialView:e="dashboard"})=>{const[t,n]=(0,a.useState)(e),s={dashboard:"Dashboard",firewall:"Firewall",scanner:"Scanner",hardening:"Hardening",activity:"Activity Log",settings:"Settings",more:"More"},c=(0,a.useCallback)(e=>{if("undefined"==typeof document)return;const a=document.getElementById("toplevel_page_wp-security-pilot");if(!a)return;a.querySelectorAll('.wp-submenu a[href*="page=wp-security-pilot"]').forEach(e=>{e.removeAttribute("aria-current");const a=e.closest("li");a&&a.classList.remove("current")});const t=I[e]||I.dashboard,n=a.querySelector(`.wp-submenu a[href*="page=${t}"]`);if(n){n.setAttribute("aria-current","page");const e=n.closest("li");e&&e.classList.add("current")}a.classList.add("current","wp-has-current-submenu")},[]),r=(0,a.useCallback)(e=>{if(e===t)return;if(n(e),"undefined"==typeof window)return;const a=I[e]||I.dashboard,l=new URL(window.location.href);l.searchParams.set("page",a),l.searchParams.delete("tab"),window.history.pushState({},"",l.toString()),c(e)},[t,c]);return(0,a.useEffect)(()=>{const e=()=>{const e=new URL(window.location.href).searchParams.get("page");e&&M[e]&&n(M[e])};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[]),(0,a.useEffect)(()=>{c(t)},[t,c]),(0,a.useEffect)(()=>{if("undefined"==typeof window)return;const e=window.wpSecurityPilotSettings?.analytics;S(Boolean(e?.enabled),e||{})},[]),(0,a.useEffect)(()=>{"undefined"!=typeof window&&((e,a)=>{if("undefined"==typeof window||window._wpspMatomoDisabled)return;const t=window._paq;t&&(e&&t.push(["setCustomUrl",e]),a&&t.push(["setDocumentTitle",a]),t.push(["trackPageView"]))})(`/wp-security-pilot/${t}`,`WP Security Pilot - ${s[t]||"Dashboard"}`)},[t]),(0,a.useEffect)(()=>{const e=e=>{const a=e.target.closest("a");if(!a||"undefined"==typeof window)return;const t=document.getElementById("toplevel_page_wp-security-pilot");if(!t||!t.contains(a))return;const n=a.getAttribute("href");if(!n||!n.includes("page=wp-security-pilot"))return;const l=new URL(n,window.location.origin).searchParams.get("page");l&&M[l]&&(e.preventDefault(),r(M[l]))};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[r]),(0,a.createElement)("div",{className:"wp-security-pilot-admin"},(0,a.createElement)("div",{className:"wp-security-pilot-shell"},(0,a.createElement)(l,{currentView:t,onNavigate:r}),(0,a.createElement)("div",{className:"content-area"},(()=>{switch(t){case"firewall":return(0,a.createElement)(E,null);case"hardening":return(0,a.createElement)(y,null);case"scanner":return(0,a.createElement)(f,null);case"activity":return(0,a.createElement)(k,null);case"settings":return(0,a.createElement)(A,null);case"more":return(0,a.createElement)(x,null);default:return(0,a.createElement)(i,null)}})())))},{initialView:T}),document.getElementById("wp-security-pilot-root"))})();